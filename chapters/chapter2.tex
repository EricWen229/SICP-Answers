\documentclass[../main.tex]{subfiles}

\begin{document}

\section{Exercise 2.1}

Code:

\begin{lstlisting}
(define (make-rat n d)
  (if (< d 0)
      (make-rat (- 0 n) (- 0 d))
      (let ((g (gcd n d)))
        (cons (/ n g) (/ d g)))))
\end{lstlisting}

\section{Exercise 2.2}

Code:

\begin{lstlisting}
;; point definition
(define (make-point x y)
  (cons x y))
(define (x-point point)
  (car point))
(define (y-point point)
  (cdr point))

;; segment definition
(define (make-segment start end)
  (cons start end))
(define (start-segment segment)
  (car segment))
(define (end-segment segment)
  (cdr segment))
(define (midpoint-segment segment)
  (define (average x y)
    (/ (+ x y) 2.0))
  (let ((start (start-segment segment))
        (end (end-segment segment)))
    (make-point (average (x-point start)
                         (x-point end))
                (average (y-point start)
                         (y-point end)))))
\end{lstlisting}

\section{Exercise 2.3}

Code:

\begin{lstlisting}
;; one version of rectangle
(define (make-rect top-left bottom-right)
  (cons top-left bottom-right))
(define (top-left rect)
  (car rect))
(define (bottom-right rect)
  (cdr rect))
(define (width rect)
  (- (x-point (bottom-right rect))
     (x-point (top-left rect))))
(define (height rect)
  (- (y-point (bottom-right rect))
     (y-point (top-left rect))))

;; another version of rectangle
(define (make-rect top-left width height)
  (cons top-left (cons width height)))
(define (top-left rect)
  (car rect))
(define (width rect)
  (car (cdr rect)))
(define (height rect)
  (cdr (cdr rect)))

;; rect procedures
(define (perimeter rect)
  (* 2 (+ (width rect) (height rect))))
(define (area rect)
  (* (width rect) (height rect)))
\end{lstlisting}

\section{Exercise 2.4}

By evaluating \lstinline{(car (cons x y))} using
 applicative-order strategy, it can be verified
 that \lstinline{(car (cons x y))} yields
 \lstinline{x} for any object \lstinline{x} and
 \lstinline{y}:

\begin{lstlisting}
(car (cons x y)) ->
(car (lambda (m) (m x y))) ->
((lambda (m) (m x y)) (lambda (p q) p)) ->
((lambda (p q) p) x y) ->
x
\end{lstlisting}

The same result can also be obtained using
 normal-order strategy:

\begin{lstlisting}
(car (cons x y)) ->
((cons x y) (lambda (p q) p)) ->
((lambda (m) (m x y)) (lambda (p q) p)) ->
((lambda (p q) p) x y) ->
x
\end{lstlisting}

The corresponding definition of \lstinline{cdr}:

\begin{lstlisting}
(define (cdr z)
  (z (lambda (p q) q)))
\end{lstlisting}

\section{Exercise 2.5}

Code:

\begin{lstlisting}
(define (cons x y)
  (* (expt 2 x) (expt 3 y)))
(define (car z)
  (define (car-iter z sum)
    (if (= (remainder z 2) 0)
        (car-iter (/ z 2) (+ 1 sum))
        sum))
  (car-iter z 0))
(define (cdr z)
  (define (cdr-iter z sum)
    (if (= (remainder z 3) 0)
        (cdr-iter (/ z 3) (+ 1 sum))
        sum))
  (cdr-iter z 0))
\end{lstlisting}

\section{Exercise 2.6}

Code:

\begin{lstlisting}
(define one (lambda (f) (lambda (x) (f x))))
(define two (lambda (f) (lambda (x) (f (f x)))))
(define (add a b)
  (lambda (f) (lambda (x) ((a f) ((b f) x)))))
\end{lstlisting}

\section{Exercise 2.7}

Code:

\begin{lstlisting}
(define (upper-bound interval)
  (car interval))
(define (lower-bound interval)
  (cdr interval))
\end{lstlisting}

\section{Exercise 2.8}

The difference of two intervals is the
 sum of the first and the opposite interval
 of the second.

Code:

\begin{lstlisting}
(define (sub-interval x y)
  (define (neg-interval x)
    (make-interval (- 0 (upper-bound x)) (- 0 (lower-bound x))))
  (add-interval x (sub-interval y)))
\end{lstlisting}

\section{Exercise 2.9}

Let $(a, b)$ denote an interval with
 lower bound $a$ and upper bound $b$.

For any two intervals $p=(p_l, p_u)$
 and $q=(q_l, q_u)$ with widths $W_p = \frac{p_u - p_l}{2}$
 and $W_q = \frac{q_u - q_l}{2}$
 respectively, the sum of $p$ and $q$ is
 $(p_l + q_l, p_u + q_u)$, whose width is
 $\frac{(p_u + q_u) - (p_l + q_l)}{2} =
 \frac{(p_u - p_l) + (q_u - q_l)}{2} = W_p + W_q$.

Similarly, the difference of $p$ and $q$ is
 $(p_l - q_u, p_u - q_l)$, whose width is
 $\frac{(p_u - q_l) - (p_l - q_u)}{2} = 
 \frac{(p_u - p_l) + (q_u - p_l)}{2} = W_p + W_q$.

Therefore, the width of the sum (or difference) of two
 intervals is a function only of the widths of the intervals
 being added (or subtracted).

Two examples illustrating that this is not true for
 multiplication or division are as follows:

\begin{itemize}
\item The width of $(0, 1) * (1, 2) = (1, 2)$ is $\frac{1}{2}$,
 while the width of $(1, 2) * (1, 2) = (1, 4)$ is $\frac{3}{2}$.
\item The width of $\frac{(0, 1)}{(1, 2)} = (0, 1) *
 (\frac{1}{2}, 1) = (0, \frac{1}{2})$ is $\frac{1}{4}$,
 while the width of $\frac{(1, 2)}{(1, 2)} = (1, 2) *
 (\frac{1}{2}, 1) = (\frac{1}{2}, 2)$ is $\frac{3}{4}$.
\end{itemize}

\end{document}










