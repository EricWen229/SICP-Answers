\documentclass[../main.tex]{subfiles}

\begin{document}

\section{Exercise 3.1}

Code:

\begin{lstlisting}
(define (make-accumulator sum)
  (lambda (x)
    (begin (set! sum (+ sum x))
           sum))))
\end{lstlisting}

Tests:

\begin{lstlisting}
(define acc-5 (make-accumulator 5))
(acc-5 1) ; 6 expected
(acc-5 2) ; 8 expected
(acc-5 3) ; 11 expected
(acc-5 4) ; 15 expected
(acc-5 -15) ; 0 expected
(define acc-neg-1 (make-accumulator -1))
(acc-neg-1 11) ; 10 expected
\end{lstlisting}

Result:

\begin{lstlisting}
6 ; pass
8 ; pass
11 ; pass
15 ; pass
0 ; pass
10 ; pass
\end{lstlisting}

Code:

\begin{lstlisting}
(define (make-monitored proc)
  (let ((count 0))
    (define (dispatch . args)
      (cond ((equal? args '(how-many-calls?)) count)
            ((equal? args '(reset-count))
             (begin (set! count 0)
                    'ok))
            (else (begin (set! count (+ 1 count))
                         (apply proc args)))))
    dispatch))
\end{lstlisting}

Tests:

\begin{lstlisting}
(define s (make-monitored sqrt))
(s 'how-many-calls?) ; 0 expected
(s 100) ; 10 expected
(s 49) ; 7 expected
(s 1) ; 1 expected
(s 0) ; 0 expected
(s 'how-many-calls?) ; 4 expected
(s 'reset-count) ; 'ok expected
(s 'how-many-calls?) ; 0 expected
(s 144) ; 12 expected
(s 64) ; 8 expected
(s 4) ; 2 expected
(s 0) ; 0 expected
(s 'how-many-calls?) ; 4 expected
\end{lstlisting}

Result:

\begin{lstlisting}
;; procedure s defined
0 ; pass
10 ; pass
7 ; pass
1 ; pass
0 ; pass
4 ; pass
ok ; pass
0 ; pass
12 ; pass
8 ; pass
2 ; pass
0 ; pass
4 ; pass
\end{lstlisting}

\end{document}










